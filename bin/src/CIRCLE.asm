__CIRCLE_DRAW MACRO XC,YC,RADIUS,COLOR
	LOCAL NEXT1,NEXT2,NEXT3,NEXT4,NEXT5,NEXT6,FINISH
	LOCAL START,LABEL1,LABEL2,LABEL3,LABEL4
	__PUSH_REGS
	PUSH SI
	PUSH DI
	PUSH BP
	
	MOV AX,DATA
	MOV DS,AX
	LEA BX,GRAPH_BUF
	
	MOV CX,XC
	MOV DX,YC
	MOV SI,0         ;X
	MOV DI,RADIUS    ;Y
	MOV BP,1
	SUB BP,RADIUS
	CMP DI,0
	JNE START
	JMP FINISH        ;如果半径为0则结束
START:
	MOV CX,XC
	SUB CX,RADIUS
	MOV DX,YC
	PUSH BX
	MOV BH,0
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	MOV CX,XC
	ADD CX,RADIUS
	MOV DX,YC
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	MOV CX,XC
	MOV DX,YC
	SUB DX,RADIUS
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	MOV CX,XC
	MOV DX,YC
	ADD DX,RADIUS
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
	CMP DI,1               ;如果半径为1
	JNE NEXT1
	JMP FINISH
NEXT1:
	CMP SI,DI
	JL NEXT2
	JMP FINISH
NEXT2:
	INC SI
NEXT3:
	CMP BP,0
	JGE NEXT4
	ADD BP,SI
	ADD BP,SI
	ADD BP,1
	JMP NEXT5
NEXT4:
	DEC DI
	ADD BP,SI
	ADD BP,SI
	SUB BP,DI
	SUB BP,DI
	ADD BP,1
NEXT5:
	CMP SI,DI
	JE LABEL1
	PUSH BX
	MOV BH,0 ;;
	MOV CX,XC
	MOV DX,YC
	ADD CX,SI
	ADD DX,DI
	;先保存，后画
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
LABEL1:
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	ADD CX,DI
	ADD DX,SI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
	
	CMP SI,DI
	JE LABEL2
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	SUB CX,SI
	ADD DX,DI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
LABEL2:
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	SUB CX,DI
	ADD DX,SI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
	
	CMP SI,DI
	JE LABEL3
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	ADD CX,SI
	SUB DX,DI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
LABEL3:
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	ADD CX,DI
	SUB DX,SI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
	
	CMP SI,DI
	JE LABEL4
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	SUB CX,SI
	SUB DX,DI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
LABEL4:	
	PUSH BX
	MOV BH,0
	MOV CX,XC
	MOV DX,YC
	SUB CX,DI
	SUB DX,SI
	MOV AH,0DH
	INT 10H
	POP BX
	MOV [BX],AL
	INC BX
	PUSH BX
	MOV BH,0
	MOV AH,0CH
	MOV AL,COLOR
	INT 10H
	POP BX
NEXT6:
	PUSH SI
	INC SI
	CMP SI,DI
	POP SI
	JGE FINISH
	JMP NEXT1
FINISH:
	
	POP BP
	POP DI
	POP SI
	__POP_REGS
	
ENDM
	
__CIRCLE_RESTORE MACRO XC,YC,RADIUS
	LOCAL NEXT1,NEXT2,NEXT3,NEXT4,NEXT5,NEXT6,FINISH
	LOCAL START,LABEL1,LABEL2,LABEL3,LABEL4
	__PUSH_REGS
	PUSH SI
	PUSH DI
	PUSH BP
	
	MOV AX,DATA
	MOV DS,AX
	LEA BX,GRAPH_BUF
	
	MOV CX,XC
	MOV DX,YC
	MOV SI,0         ;X
	MOV DI,RADIUS    ;Y
	MOV BP,1
	SUB BP,RADIUS
	CMP DI,0
	JNE START
	JMP FINISH        ;如果半径为0则结束
START:
	MOV CX,XC
	SUB CX,RADIUS
	MOV DX,YC
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	
	MOV CX,XC
	ADD CX,RADIUS
	MOV DX,YC
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	
	MOV CX,XC
	MOV DX,YC
	SUB DX,RADIUS
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	
	MOV CX,XC
	MOV DX,YC
	ADD DX,RADIUS
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	CMP SI,DI
	JNE NEXT1
	JMP FINISH
NEXT1:
	CMP SI,DI
	JL NEXT2
	JMP FINISH
NEXT2:
	INC SI
NEXT3:
	CMP BP,0
	JGE NEXT4
	ADD BP,SI
	ADD BP,SI
	ADD BP,1
	JMP NEXT5
NEXT4:
	DEC DI
	ADD BP,SI
	ADD BP,SI
	SUB BP,DI
	SUB BP,DI
	ADD BP,1
NEXT5:
	CMP SI,DI
	JE LABEL1
	MOV CX,XC
	MOV DX,YC
	ADD CX,SI
	ADD DX,DI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
LABEL1:
	MOV CX,XC
	MOV DX,YC
	ADD CX,DI
	ADD DX,SI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	
	CMP SI,DI
	JE LABEL2
	MOV CX,XC
	MOV DX,YC
	SUB CX,SI
	ADD DX,DI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
LABEL2:
	MOV CX,XC
	MOV DX,YC
	SUB CX,DI
	ADD DX,SI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	
	CMP SI,DI
	JE LABEL3
	MOV CX,XC
	MOV DX,YC
	ADD CX,SI
	SUB DX,DI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
LABEL3:
	MOV CX,XC
	MOV DX,YC
	ADD CX,DI
	SUB DX,SI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
	
	CMP SI,DI
	JE LABEL4
	MOV CX,XC
	MOV DX,YC
	SUB CX,SI
	SUB DX,DI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
LABEL4:
	MOV CX,XC
	MOV DX,YC
	SUB CX,DI
	SUB DX,SI
	MOV AH,0CH
	MOV AL,[BX]
	INC BX
	PUSH BX
	MOV BH,0
	INT 10H
	POP BX
NEXT6:
	PUSH SI
	INC SI
	CMP SI,DI
	POP SI
	JGE FINISH
	JMP NEXT1
FINISH:
	POP BP
	POP DI
	POP SI
	__POP_REGS
	
ENDM
	