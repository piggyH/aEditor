INCLUDE MACRO.ASM

EXTRN _DISPLAY_STRING:FAR
EXTRN _SAVE_BLOCK:FAR
EXTRN _RESTORE_BLOCK:FAR
EXTRN _WRITE_BLOCK_PIXEL:FAR

;;设置颜色，图形参数

EXTRN _DRAW_MOUSE:FAR
;
PUBLIC _SET_LINE
PUBLIC _SET_POLYLINE
PUBLIC _SET_CIRCLE
PUBLIC _SET_ARC
PUBLIC _SET_ELLIPSE
PUBLIC _SET_RED
PUBLIC _SET_GREEN
PUBLIC _SET_BLUE

;
PUBLIC DRAW_TYPE,DRAW_COLOR
GLOBAL SEGMENT PUBLIC
	DRAW_TYPE  DB 0 ; 0:LINE 1:POLYLINE 2:CIRCLE
					; 3:ARC  4:ELLIPSE
	DRAW_COLOR DB 04H
	EXTRN MOUSE_BUF:BYTE,BUF:BYTE
	EXTRN CUR_X:WORD,CUR_Y:WORD
	EXTRN ON_LEFT_CLICK:WORD
	EXTRN COLOR_CLICK:BYTE,GRAPH_CLICK:BYTE
GLOBAL ENDS
;

DATA SEGMENT
	S_COLOR     DB      'COLOR'
	S_GRAPH     DB      'GRAPH'
	S_LINE 		DB 		' LINE    '
	S_POLYLINE  DB      ' POLYLINE'
	S_CIRCLE 	DB 		' CIRCLE  '
	S_ARC 		DB 		' ARC     '
	S_ELLIPSE 	DB 		' ELLIPSE '
DATA ENDS


CODE SEGMENT
	ASSUME CS:CODE,ES:GLOBAL

__SET_GRAPH MACRO TYPE                ;设置画图类型及显示在状态栏
	__DELAY 33144
	PUSH AX
	PUSH ES
	MOV AX,GLOBAL
	MOV ES,AX
	MOV ES:GRAPH_CLICK,0
	MOV ES:ON_LEFT_CLICK,0
	__RESTORE_BLOCK ES:CUR_X,ES:CUR_Y,12,19,ES:MOUSE_BUF
	__RESTORE_BLOCK 152,32,80,80,ES:BUF                
	__DISPLAY_STRING 1,20,DATA,S_GRAPH,5,09H
	__SAVE_BLOCK ES:CUR_X,ES:CUR_Y,12,19,ES:MOUSE_BUF  
	CALL _DRAW_MOUSE
	__CHANGE_DRAW_TYPE TYPE
	__DISPLAY_DRAW_TYPE
	POP ES
	POP AX
	ENDM
	
_SET_LINE PROC FAR
	__SET_GRAPH 0
	; __CHANGE_DRAW_TYPE 0
	; __DISPLAY_DRAW_TYPE
	RET
_SET_LINE ENDP

_SET_POLYLINE PROC FAR
	__SET_GRAPH 1
	; __CHANGE_DRAW_TYPE 1
	; __DISPLAY_DRAW_TYPE
	RET
_SET_POLYLINE ENDP

_SET_CIRCLE PROC FAR
	__SET_GRAPH 2
	; __CHANGE_DRAW_TYPE 2
	; __DISPLAY_DRAW_TYPE
	RET
_SET_CIRCLE ENDP

_SET_ARC PROC FAR
	__SET_GRAPH 3
	; __CHANGE_DRAW_TYPE 3
	; __DISPLAY_DRAW_TYPE
	RET
_SET_ARC ENDP

_SET_ELLIPSE PROC FAR
	__SET_GRAPH 4
	RET
_SET_ELLIPSE ENDP

__SET_COLOR MACRO COLOR            ;设置画图颜色及显示在状态栏
	__DELAY 33144
	PUSH AX
	PUSH ES
	MOV AX,GLOBAL
	MOV ES,AX
	MOV ES:COLOR_CLICK,0
	MOV ES:ON_LEFT_CLICK,0
	__RESTORE_BLOCK ES:CUR_X,ES:CUR_Y,12,19,ES:MOUSE_BUF
	__RESTORE_BLOCK 232,32,56,48,ES:BUF
	__DISPLAY_STRING 1,30,DATA,S_COLOR,5,09H
	__SAVE_BLOCK ES:CUR_X,ES:CUR_Y,12,19,ES:MOUSE_BUF
	CALL _DRAW_MOUSE
	POP ES
	POP AX
	__CHANGE_DRAW_COLOR COLOR
	__DISPLAY_DRAW_COLOR
	__DISPLAY_DRAW_TYPE
	ENDM
	
_SET_RED PROC FAR
	__SET_COLOR 04H
	RET
_SET_RED ENDP

_SET_GREEN PROC FAR
	__SET_COLOR 02H
	RET
_SET_GREEN ENDP

_SET_BLUE PROC FAR
	__SET_COLOR 01H
	RET
_SET_BLUE ENDP
	
CODE ENDS
END


	